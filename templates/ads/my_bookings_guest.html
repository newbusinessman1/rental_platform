{% extends "base.html" %}
{% block title %}My bookings (guest) — StayFinder{% endblock %}

{% block content %}
<div class="max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 py-10">
  <h1 class="text-3xl font-bold mb-6">My bookings (guest)</h1>

  {% if not user.email %}
    <div class="p-4 mb-6 rounded bg-yellow-50 text-yellow-800 border border-yellow-200">
      Your profile has no email. Bookings are linked to email, so nothing will show here.
    </div>
  {% endif %}

  {% if bookings %}
    <div class="space-y-4">
      {% for b in bookings %}
        <div class="p-4 rounded border bg-white shadow-sm flex items-center justify-between">
          <div>
            <div class="font-semibold">{{ b.listing.title }}</div>
            <div class="text-sm text-gray-600">
              Даты:
              {% if b.check_in %}{{ b.check_in|date:"d.m.Y" }}{% else %}—{% endif %}
              →
              {% if b.check_out %}{{ b.check_out|date:"d.m.Y" }}{% else %}—{% endif %}
              • Статус:
              {% if b.status == "approved" %}
                <span class="px-2 py-0.5 rounded bg-green-100 text-green-800">approved</span>
              {% elif b.status == "declined" %}
                <span class="px-2 py-0.5 rounded bg-red-100 text-red-800">declined</span>
              {% else %}
                <span class="px-2 py-0.5 rounded bg-yellow-100 text-yellow-800">pending</span>
              {% endif %}
            </div>
          </div>

          <!-- ВЕДЁТ НА ДЕТАЛИ БРОНИ -->
          <a href="{% url 'ads:booking_detail' pk=b.id %}"
             class="px-3 py-2 rounded bg-gray-800 text-white hover:bg-gray-900">
            Open
          </a>
        </div>
      {% endfor %}
    </div>
  {% else %}
    <p class="text-gray-600">У вас пока нет бронирований.</p>
  {% endif %}
</div>
{% endblock %}